<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>OneShop - Trang ch·ªß</title>

  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" th:href="@{/css/header.css}">
  <link rel="stylesheet" th:href="@{/css/banner.css}">
  <link rel="stylesheet" th:href="@{/css/footer.css}">
  <link rel="stylesheet" th:href="@{/css/index.css}">

  <script src="https://kit.fontawesome.com/a2e0e6ad8b.js" crossorigin="anonymous"></script>
</head>

<body>

<div th:replace="~{fragments/_header :: header}"></div>

<main>
  <!-- ==================== BANNER ==================== -->
  <section class="banner-section">
    <div class="swiper bannerSwiper">
      <div class="swiper-wrapper">

        <div class="swiper-slide">
          <img th:src="@{/images/banner/banner1.jpg}">
          <div class="banner-content top-left">
            <h2>Kh√°m ph√° <br><span> s·∫Øc ƒë·∫πp t·ª± nhi√™n</span></h2>
            <p>B·ªô s∆∞u t·∫≠p m·ªπ ph·∫©m cao c·∫•p gi√∫p b·∫°n t·ª± tin t·ªèa s√°ng m·ªói ng√†y</p>
            <a href="#" class="shop-btn">Mua ngay</a>
          </div>
        </div>

        <div class="swiper-slide">
          <img th:src="@{/images/banner/banner2.jpg}">
          <div class="banner-content center-left">
            <h2>ƒê·∫πp chu·∫©n <span>phong c√°ch</span></h2>
            <p>Th·ªùi trang & m·ªπ ph·∫©m d√†nh cho qu√Ω c√¥ hi·ªán ƒë·∫°i</p>
            <a href="#" class="shop-btn">Kh√°m ph√° ngay</a>
          </div>
        </div>

        <div class="swiper-slide">
          <img th:src="@{/images/banner/banner3.jpg}">
          <div class="banner-content center-left">
            <h2><span>∆Øu ƒë√£i c·ª±c l·ªõn</span> th√°ng n√†y</h2>
            <p>Gi·∫£m ƒë·∫øn 50% cho d√≤ng son v√† d∆∞·ª°ng da cao c·∫•p</p>
            <a href="#" class="shop-btn">Xem chi ti·∫øt</a>
          </div>
        </div>
      </div>

      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-pagination"></div>
    </div>
  </section>

  <!-- ==================== BY CATEGORIES ==================== -->
  <section class="categories">
  <h2>By Categories</h2>
  <div class="category-list">
    <div th:each="c : ${categories}" class="category-card">
      <a th:href="@{'/shop'(category=${c.name})}">
        <img th:src="@{${c.imageUrl}}" th:alt="${c.name}">
        <p th:text="${c.name}"></p>
      </a>
    </div>
  </div>
</section>

<!-- ==================== SUBSCRIBE SECTION ==================== -->
<section class="subscribe-section" style="background-image: url('/images/banner/subscribe-bg.jpg');">
  <div class="overlay"></div>
  <div class="subscribe-content">
    <h2>üå∏ H√£y theo d√µi <span>Eighteen Beauty</span> ƒë·ªÉ nh·∫≠n nhi·ªÅu ∆∞u ƒë√£i</h2>
    <p>C√πng c·∫≠p nh·∫≠t c√°c xu h∆∞·ªõng l√†m ƒë·∫πp, khuy·∫øn m√£i v√† s·∫£n ph·∫©m m·ªõi m·ªói tu·∫ßn!</p>

    <form id="subscribeForm" onsubmit="return handleSubscribe(event)">
      <input type="email" id="subscribeEmail" placeholder="Nh·∫≠p email c·ªßa b·∫°n..." required>
      <button type="submit">ƒêƒÇNG K√ù</button>
    </form>

    <div id="subscribeMessage" class="subscribe-message"></div>
  </div>
</section>


<!-- ==================== FEATURED PRODUCTS ==================== -->
<section class="featured-products">
  <div class="tabs">
    <button class="tab active" onclick="showTab('new')">NEW PRODUCTS</button>
    <button class="tab" onclick="showTab('sale')">ON SALE</button>
    <button class="tab" onclick="showTab('feature')">FEATURE PRODUCTS</button>
  </div>

  <!-- üÜï NEW PRODUCTS -->
  <div class="tab-content active" id="tab-new">
    <div class="product-list">
      <div th:each="p : ${newProducts}" class="product-card">
  <a th:href="@{'/shop/product/' + ${p.productId}}" class="product-link">
    <div class="badge new">New</div>
    <img th:src="${p.imageUrl != null ? p.imageUrl : '/images/products/default.jpg'}" th:alt="${p.name}">
    <h3 th:text="${p.name}"></h3>

    <!-- ‚≠ê Rating -->
    <div class="stars" th:if="${p.rating != null}">
      <i class="fa-solid fa-star" th:each="i : ${#numbers.sequence(1, p.rating.intValue())}"></i>
      <i class="fa-regular fa-star" th:each="i : ${#numbers.sequence(1, 5 - p.rating.intValue())}"></i>
    </div>

    <!-- üí∞ Gi√° -->
    <p class="price" th:text="${@productServiceImpl.getPriceRange(p)}"></p>
  </a>
</div>

    </div>
  </div>

  <!-- üí∏ ON SALE -->
  <div class="tab-content" id="tab-sale">
    <div class="product-list">
      <div th:each="p : ${bestDeals}" class="product-card">
  <a th:href="@{'/shop/product/' + ${p.productId}}" class="product-link">
    <div class="badge sale"
         th:if="${p.variants != null and !#lists.isEmpty(p.variants) and p.variants[0].oldPrice != null}"
         th:text="'-' + ${T(java.lang.Math).round((1 - (p.variants[0].price.doubleValue() / p.variants[0].oldPrice.doubleValue())) * 100)} + '%'">
    </div>

    <img th:src="${p.imageUrl != null ? p.imageUrl : '/images/products/default.jpg'}" th:alt="${p.name}">
    <h3 th:text="${p.name}"></h3>

    <div class="stars" th:if="${p.rating != null}">
      <i class="fa-solid fa-star" th:each="i : ${#numbers.sequence(1, p.rating.intValue())}"></i>
      <i class="fa-regular fa-star" th:each="i : ${#numbers.sequence(1, 5 - p.rating.intValue())}"></i>
    </div>

    <p class="price">
      <span class="old" th:if="${p.variants[0].oldPrice != null}"
            th:text="${#numbers.formatDecimal(p.variants[0].oldPrice, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
      <span class="new"
            th:text="${#numbers.formatDecimal(p.variants[0].price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
    </p>
  </a>
</div>

    </div>
  </div>

  <!-- üåü FEATURE PRODUCTS -->
  <div class="tab-content" id="tab-feature">
    <div class="product-list">
      <div th:each="p : ${highlightProducts}" class="product-card">
  <a th:href="@{'/shop/product/' + ${p.productId}}" class="product-link">
    <img th:src="${p.imageUrl != null ? p.imageUrl : '/images/products/default.jpg'}" th:alt="${p.name}">
    <h3 th:text="${p.name}"></h3>

    <div class="stars" th:if="${p.rating != null}">
      <i class="fa-solid fa-star" th:each="i : ${#numbers.sequence(1, p.rating.intValue())}"></i>
      <i class="fa-regular fa-star" th:each="i : ${#numbers.sequence(1, 5 - p.rating.intValue())}"></i>
    </div>

    <p class="price" th:text="${@productServiceImpl.getPriceRange(p)}"></p>
  </a>
</div>

    </div>
  </div>
</section>

<script>
function showTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.querySelector(`.tab[onclick="showTab('${tab}')"]`).classList.add('active');
  document.getElementById(`tab-${tab}`).classList.add('active');
}
</script>

</main>

<div th:replace="~{fragments/_footer :: footer}"></div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  const swiper = new Swiper(".bannerSwiper", {
    loop: true,
    autoplay: { delay: 4000, disableOnInteraction: false },
    pagination: { el: ".swiper-pagination", clickable: true },
    navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
    effect: "fade",
    fadeEffect: { crossFade: true },
  });

  // ·∫®n header-top khi cu·ªôn xu·ªëng
  const headerTop = document.querySelector('.header-top');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 60) {
      headerTop.classList.add('hidden');
    } else {
      headerTop.classList.remove('hidden');
    }
  });
</script>

<script>
function handleSubscribe(event) {
  event.preventDefault();
  const emailInput = document.getElementById("subscribeEmail");
  const messageDiv = document.getElementById("subscribeMessage");

  if (!emailInput.value.trim()) {
    messageDiv.textContent = "‚ùå Vui l√≤ng nh·∫≠p email h·ª£p l·ªá!";
    messageDiv.style.color = "#ffb3b3";
    return false;
  }

  // Gi·∫£ l·∫≠p g·ª≠i th√†nh c√¥ng
  messageDiv.textContent = `‚úÖ C·∫£m ∆°n b·∫°n ${emailInput.value.trim()}! Eighteen Beauty s·∫Ω g·ª≠i ƒë·∫øn b·∫°n th·∫≠t nhi·ªÅu ∆∞u ƒë√£i nh√© üå∏`;
  messageDiv.style.color = "#d6f5d6";

  // Reset form sau 2s
  setTimeout(() => {
    emailInput.value = "";
    messageDiv.textContent = "";
  }, 4000);

  return false;
}
</script>

</body>
</html>
